<!DOCTYPE html>
<html lang="en">
<head>
    <!--DEV-ONLY-NOT-LOADED-DURING-RUNTIME-->
    <link href="../common/style/bootstrap.css" rel="stylesheet">
    <link href="../common/style/style.css" rel="stylesheet">
    <!--[onshow;block=head;when [visible.foo] == bar;comm]-->
    <!--DEV-ONLY-NOT-LOADED-DURING-RUNTIME-->
</head>
<!--HEAD - ONLOAD-->
<!--[onload;file=../common/common.head.html;getbody;comm]-->
<!--HEAD - ONLOAD-->
<body>
<!--JS SECTION - ONLOAD-->
<!--[onload;file=../common/common.javascript.html;getbody;comm]-->
<!--JS SECTION - ONLOAD-->
<!--DEBUG SECTION - ONLOAD-->
<!--[onload;file=../common/include.debug.html;getbody;comm]-->
<!--DEBUG SECTION - ONLOAD-->
<!--HEADER SECTION - ONLOAD-->
<!--[onload;file=common.header.html;getbody;comm]-->
<!--HEADER SECTION - ONLOAD-->
<!-- Main content starts -->
<div class="content">
    <!-- Sidebar -->
    <div class="sidebar">
        <!--SIDE MENU - ONLOAD -->
        <!--[onload;file=common.menu.html;getbody;comm]-->
        <!--SIDE MENU - ONLOAD -->
    </div>
    <!-- Sidebar ends -->
    <!-- Main bar -->
    <div class="mainbar">
        <!----------------------COMMON PAGE HEADING--------------------------------->
        <!--[onload;file=common.heading.html;getbody;comm]-->
        <!----------------------COMMON PAGE HEADING--------------------------------->
        <!-- Matter -->
        <div class="matter">
            <div class="container">
                <!----------------------COMMON NOTICES--------------------------------->
                <!--[onload;file=../common/common.notices.html;getbody;comm]-->
                <!----------------------COMMON NOTICES--------------------------------->
                <!--WI_QUOTATIONS_TABLE-->
                <div class="row fullscreen-mode">
                    <div class="col-md-12">
                        <a data-toggle="modal" data-target="#addNewList" class="btn btn-success">Add new milestone</a>
                    </div>
                    <div class="col-md-12">
                        <div class="widget">
                            <div class="widget-content">
                                <table class="footable table table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th style="width:65px;" data-hide="phone"><a href="[vars.sortby_id;noerr]">
                                            [lang.lang_id]<i class="icon-sort bns-padded-left"></i></a></th>
                                        <th><a href="[vars.sortby_form_title;noerr]" data-hide="phone">Title<i
                                                class="icon-sort bns-padded-left"></i></a></th>
                                        <th style="width:150px;">[lang.lang_deadline]</th>
                                        <th style="width:55px; text-align:center; font-size:14px;">
                                            <i class="icon-reorder"></i></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr id="milestone-[milestones.id]">
                                        <!--[milestones.id;block=tr]-->
                                        <td>[milestones.id;]</td>
                                        <td>[milestones.title]</td>
                                        <td>[milestones.days]</td>
                                        <td>
                                            <a class="btn btn-xs btn-primary" data-id="[milestones.id]"
                                               data-toggle="modal"
                                               data-target="#modify-milestone"
                                               title="Edit"
                                               data-title="[milestones.title]"
                                               data-start="[milestones.start_date]"
                                               data-end="[milestones.end_date]"
                                               data-days="[milestones.days]"
                                               id="edit-milestone"
                                            >
                                                <i class="fa fa-edit"></i>
                                            </a>
                                            <a class="btn btn-xs btn-danger ajax-delete-record"
                                               data-popconfirm-yes="[lang.lang_yes;noerr]"
                                               data-popconfirm-no="[lang.lang_no;noerr]"
                                               data-popconfirm-title="[lang.lang_confirm_delete_milestone;noerr]"
                                               data-popconfirm-placement="left"
                                               data-mysql-record-id="[milestones.id]"
                                               data-ajax-url="[conf.site_url]/admin/ajax/delete-milestone-single"><i
                                                    class="icon-trash"></i></a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="widget-foot">
                                    <ul class="pagination pull-right">
                                        [vars.pagination;noerr;htmlconv=no]
                                    </ul>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!--[onshow;block=div;when [visible.wi_notification] == 1;comm]-->
                    <div class="col-md-12">
                        <div class="widget">
                            <div class="widget-content widget-big-box">[vars.notification;noerr]</div>
                        </div>
                    </div>
                </div>
                <!--WI_NOTIFICATION-->
            </div>
        </div>
        <!-- Matter ends -->
    </div>
    <!-- Mainbar ends -->
    <div class="clearfix"></div>
</div>
<!-- Content ends -->
<!----------------------COMMON FOOTER--------------------------------->
<!--[onload;file=../common/common.footer.html;getbody;comm]-->
<!----------------------COMMON FOOTER--------------------------------->
<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="icon-chevron-up"></i></a></span>

<!--WI_IFRAME_MODAL-->
<div class="row">
    <div id="addNewList" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <form action="" method="post">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                        <!--full screen icon - custom.js-->
                        <button type="button" class="full-screen-modal close" aria-hidden="true"><i
                                class="icon-fullscreen"></i></button>
                        <!--full screen icon - custom.js-->
                        <h4 class="modal-title">
                            [lang.lang_edit]</h4>
                        <div class="clearfix"></div>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="label label-info">Milestone title</label>
                            <input type="text" name="title" class="form-control" placeholder="Enter milestone title"
                                   required="required"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info"> [lang.lang_start_date]</label>
                            <input type="text" class="form-control pickadate" name="milestones_start_date"
                                   id="milestones_start_date"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info"> [lang.lang_end_date]</label>
                            <input type="text" class="form-control pickadate" name="milestones_end_date"
                                   id="milestones_end_date"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info">[lang.lang_days]</label>
                            <input type="text" name="days" class="form-control"/>
                        </div>
                        <div class="form-group">
                            <span class="label text-muted">
                                Note: If start and end dates are provided, Milestone duration (days) will be ignored.
                            </span>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-default" aria-hidden="true">Add</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
</div>

<div class="row">
    <div id="modify-milestone" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <form action="" method="post" class="modify-milestone">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                        <!--full screen icon - custom.js-->
                        <button type="button" class="full-screen-modal close" aria-hidden="true"><i
                                class="icon-fullscreen"></i></button>
                        <!--full screen icon - custom.js-->
                        <h4 class="modal-title">
                            [lang.lang_edit]</h4>
                        <div class="clearfix"></div>
                    </div>
                    <input type="hidden" name="id" id="edit-id"/>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="label label-info">Milestone title</label>
                            <input type="text" name="title" id="edit-title" class="form-control"
                                   placeholder="Enter milestone title"
                                   required="required"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info"> [lang.lang_start_date]</label>
                            <input type="text" class="form-control pickadate" name="milestones_start_date"
                                   id="edit-start"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info"> [lang.lang_end_date]</label>
                            <input type="text" class="form-control pickadate" name="milestones_end_date"
                                   id="edit-end"/>
                        </div>
                        <div class="form-group">
                            <label class="label label-info">[lang.lang_days]</label>
                            <input type="text" name="days" id="edit-days" class="form-control"/>
                        </div>
                        <div class="form-group">
                            <span class="label text-muted">
                                Note: If start and end dates are provided, Milestone duration (days) will be ignored.
                            </span>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-default" aria-hidden="true">
                            [lang.lang_save]
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!--WI_IFRAME_MODAL-->
<div class="row">
    <div id="modalIframe" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                    <!--full screen icon - custom.js-->
                    <button type="button" class="full-screen-modal close" aria-hidden="true"><i
                            class="icon-fullscreen"></i></button>
                    <!--full screen icon - custom.js-->
                    <h4 class="modal-title" id="modal-iframe-title">
                        [lang.lang_edit]</h4>
                    <div class="clearfix"></div>
                </div>
                <div class="modal-body">
                    <iframe frameborder="0" class="slimScrollBarModal----"></iframe>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" aria-hidden="true">
                        [lang.lang_close]
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!--WI_IFRAME_MODAL-->
<!--JS_SELECT_LISTS-->
<!--JS_SELECT_LISTS-->
<!--------------------COMMON FOOTER JAVASCRIPT---------------------------->
<!--[onload;file=../common/common.footer.javascript.html;getbody;comm]-->
<!--------------------COMMON FOOTER JAVASCRIPT---------------------------->

<script type="text/javascript">
    $(function () {
        var id = $('#edit-id');
        var title = $('#edit-title');
        var days = $('#edit-days');
        var start = $('#edit-start');
        var end = $('#edit-end');
        $('a#edit-milestone').click(function () {
            var data = $(this).data();
            id.val(data.id);
            title.val(data.title);
            days.val(data.days);
            start.val(data.start);
            end.val(data.end);
        });
        $('.modify-milestone').submit(function (e) {
            e.preventDefault();
            $.ajax({
                url: '[conf.site_url]/admin/ajax/save-milestone-single',
                data: $(this).serialize(),
                type: 'POST',
                dataType: 'json',
                success: function (res) {

                    var target = $('tr#milestone-' + id.val()).children('td');
                    target.eq(0).html(id.val());
                    target.eq(1).html(title.val());
                    target.eq(2).html(days.val());

                    var modal_button = target.eq(3).find('a#edit-milestone');

                    modal_button.data('id', id.val());
                    modal_button.data('title', title.val());
                    modal_button.data('days', days.val());
                    modal_button.data('start', start.val());
                    modal_button.data('end', end.val());

                    $('#modify-milestone').modal('toggle');
                    setTimeout(function () {
                        noty(
                                {
                                    text: res.message,
                                    layout: 'bottomRight',
                                    type: 'information',
                                    timeout: 1500
                                }
                        );
                    }, 300);
                }
            })
        })
    })
</script>

</body>
</html>
